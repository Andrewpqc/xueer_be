{"version":3,"sources":["webpack:///./js/search.js"],"names":[],"mappings":"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","file":"search.bundle.js","sourcesContent":["/**\n * search.js\n *\n * authored by zindex\n */\n\n'use strict';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nconst $ = require(\"jquery\");\n\nconst SearchBox = (props) => {\n\treturn <input id=\"inputBox\" type=\"text\" className=\"input\" placeholder=\"课程名、标签\" onFocus={props.onFocusHandler}  onBlur={props.onBlurHandler} onChange={props.onChangeHandler}/>\n}\n\nconst PopBox = (props) => {\n\t\tconst styles = { \n\t\t\tshow:{\n\t\t\t\tdisplay:\"block\"\n\t\t\t},\n\t\t\thide:{\n\t\t\t\tdisplay:\"none\"\n\t\t\t}\n\t\t}\n\t\treturn <div style={((!props.isFocus)&&(!props.isBoxClicked))?styles.hide:styles.show} className=\"pop_box\">{ props.children }</div>\n}\n\nconst PopList = (props) => {\n\t\tvar styles = {\n\t\t\tshow:{\n\t\t\t\tdisplay:\"block\"\n\t\t\t},\n\t\t\thide:{\n\t\t\t\tdisplay:\"none\"\n\t\t\t}\n\t\t}\n\t\treturn <div style={props.hasResult?styles.show:styles.hide} className=\"pop_list\">{ props.children }</div>\n}\n\nconst PopListItem = (props) => {\n\treturn <a className=\"item\" href={ '/course/' + props.data.id + '/'}>{ props.data.title }</a>\n}\n\nconst TagBox = (props) => {\n\treturn <div className=\"tag\"><a href={ '/search/?keywords=' + props.data }>{ props.data }</a></div>\n}\n\nconst HotTags = (props) => {\n\tvar styles = {\n\t\t\tshow:{\n\t\t\t\tdisplay:\"block\"\n\t\t\t},\n\t\t\thide:{\n\t\t\t\tdisplay:\"none\"\n\t\t\t}\n\t\t}\n\t\treturn <div style={props.isTyping&&props.hasResult?styles.hide:styles.show} className=\"hot_tags\">\n\t\t\t   \t<div className=\"tag_title\" onClick={props.onClickHandler} ><a href=\"/login\">大家都在搜</a></div>\n\t\t\t   \t<div className=\"tag_list\">\n\t\t\t\t\t{ props.children }\n\t\t\t   \t</div>\n\t\t\t   </div>\n}\n\n\n\nclass SearchComponent extends React.Component{\n\tconstructor(){\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tisFocus:false,\n\t\t\tisBoxClicked:false,\n\t\t\tisTyping:false,\n\t\t\thasResult:false,\n\t\t\tlist:[],\n\t\t\thot_tags:[]\n\t\t};\n\t\tthis._onFocusHandler = this._onFocusHandler.bind(this);\n\t\tthis._onBlurHandler = this._onBlurHandler.bind(this);\n\t\tthis._onChangeHandler = this._onChangeHandler.bind(this);\n\t\tthis._onMouseDownHandler = this._onMouseDownHandler.bind(this);\n\t}\n\tcomponentDidMount() {\n    \twindow.addEventListener('mousedown', this._onMouseDownHandler, true);\n    \t$.get(\"/api/v1.0/search/hot/\").done((res) => {\n    \t\tthis.setState({hot_tags: JSON.parse(res) })\n    \t})\n\t}\n\t_onFocusHandler(){\n\t\tthis.setState({isFocus:true})\n\t\tthis.setState({isBoxClicked:false})\n\t}\n\t_onMouseDownHandler(e){\n\t\tif (ReactDOM.findDOMNode(this).contains(e.target)){\n\t\t\tif (e.target.id !== \"inputBox\"){\n\t\t\t\tthis.setState({isBoxClicked:true})\n\t\t\t}\n\t\t}else{\n\t\t\tthis.setState({isBoxClicked:false})\n\t\t}\n\t}\n\t_onBlurHandler(e){\n\t\tthis.setState({isFocus:false})\n\t}\n\t_onChangeHandler(e){\n\t\tvar val = e.target.value,\n\t\tthat = this;\n\t\tif(val !== \"\"){\n\t\t\tthis.setState({isTyping:true})\n\t\t\tvar url = \"/api/v1.0/search/?page=1&per_page=20&keywords=\" + encodeURIComponent(val)\n\t\t\t$.get(url).done(function(data){\n\t\t\t\tvar l_data = JSON.parse(data);\n\t\t\t\tif(l_data.length){\n\t\t\t\t\tthat.setState({list:JSON.parse(data),hasResult:true})\n\t\t\t\t}else{\n\t\t\t\t\tthat.setState({hasResult:false})\n\t\t\t\t}\n\t\t\t}).fail(function(){\n\t\t\t})\n\t\t}else{\n\t\t\tthis.setState({isTyping:false,hasResult:false})\n\t\t}\n\t}\n\trender(){\n\t\tlet pop_list = [];\n    let hot_tags = [];\n\t\tthis.state.list.map((x,i) => pop_list.push(<PopListItem key={i} data={x} id={i} />));\n\t\tthis.state.hot_tags.map((x,i) => hot_tags.push(<TagBox key={i} data={x} id={i} />));\n\t\treturn <div className=\"search_container\">\n\t\t\t\t\t<PopBox isFocus={this.state.isFocus} isBoxClicked={this.state.isBoxClicked} >\n\t\t\t\t\t\t<HotTags isTyping={this.state.isTyping} hasResult={this.state.hasResult}>\n\t\t\t\t\t\t\t{hot_tags}\n\t\t\t\t\t\t</HotTags>\n\t\t\t\t\t\t<PopList hasResult={this.state.hasResult}>\n\t\t\t\t\t\t\t{pop_list}\n\t\t\t\t\t\t</PopList>\n\t\t\t\t\t</PopBox>\n\t\t\t\t\t<SearchBox onFocusHandler={this._onFocusHandler} onBlurHandler={this._onBlurHandler} onChangeHandler={this._onChangeHandler}></SearchBox>\n\t\t\t   </div>\n\t}\n}\n\n//init search box\nif (document.querySelector(\".search_component_inject\")){\n\tReactDOM.render( <SearchComponent/> , document.querySelector(\".search_component_inject\"));\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./js/search.js\n **/"],"sourceRoot":""}